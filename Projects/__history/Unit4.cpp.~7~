//---------------------------------------------------------------------------

#include <fmx.h>
#pragma hdrstop

#include "Unit4.h"
#include "TaskListEmployee.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.fmx"
TEmployeeProfile *EmployeeProfile;
//---------------------------------------------------------------------------
__fastcall TEmployeeProfile::TEmployeeProfile(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TEmployeeProfile::TaskListButtonClick(TObject *Sender)
{
    TaskList->Show();
}
//---------------------------------------------------------------------------
void __fastcall TEmployeeProfile::FormShow(TObject *Sender)
{
    	try {
		// Set up the SQL query to check user credentials.
		FDQuery1->SQL->Text = "SELECT * FROM Employee WHERE Username = :username";
		FDQuery1->Params->ParamByName("username")->Value = usernameEmployee;


		// Execute the query.
		FDQuery1->Open();

		// Check if a matching record was found.
		if (!FDQuery1->Eof) {
			// Login successful; show the next form or perform other actions.
			SharedName = FDQuery1->FieldByName("Name")->AsString;
			ShowMessage("Login successful!");
			// Open the next form:

			EmployeeProfile->Show();
        } else {
            // Login failed; display an error message.
			ShowMessage("Login failed. Please check your username provided by the company.");
        }
    } catch (Exception &e) {
        ShowMessage("Error: " + e.Message);
	}
	FDQuery2->Close();
}
//---------------------------------------------------------------------------
